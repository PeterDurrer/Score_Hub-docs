import{_ as i,c as a,o as e,ag as t}from"./chunks/framework.dvv-DFtf.js";const c=JSON.parse('{"title":"GitHub Secrets Konfiguration","description":"","frontmatter":{},"headers":[],"relativePath":"setup/github-secrets.md","filePath":"setup/github-secrets.md"}'),n={name:"setup/github-secrets.md"};function l(h,s,r,p,k,o){return e(),a("div",null,[...s[0]||(s[0]=[t(`<h1 id="github-secrets-konfiguration" tabindex="-1">GitHub Secrets Konfiguration <a class="header-anchor" href="#github-secrets-konfiguration" aria-label="Permalink to &quot;GitHub Secrets Konfiguration&quot;">​</a></h1><p>Die CI/CD Pipeline benötigt verschiedene Secrets für das Deployment.</p><h2 id="environments-einrichten" tabindex="-1">Environments einrichten <a class="header-anchor" href="#environments-einrichten" aria-label="Permalink to &quot;Environments einrichten&quot;">​</a></h2><h3 id="_1-environments-erstellen" tabindex="-1">1. Environments erstellen <a class="header-anchor" href="#_1-environments-erstellen" aria-label="Permalink to &quot;1. Environments erstellen&quot;">​</a></h3><ol><li>GitHub Repository → Settings → Environments</li><li>Erstellen Sie: <ul><li><code>staging</code></li><li><code>production</code> (mit Required reviewers)</li></ul></li></ol><h3 id="_2-production-protection-rules" tabindex="-1">2. Production Protection Rules <a class="header-anchor" href="#_2-production-protection-rules" aria-label="Permalink to &quot;2. Production Protection Rules&quot;">​</a></h3><p>Für <code>production</code> Environment:</p><ul><li>✓ Required reviewers: Mindestens 1 Reviewer</li><li>✓ Wait timer: Optional (z.B. 5 Minuten)</li></ul><h2 id="azure-service-principal" tabindex="-1">Azure Service Principal <a class="header-anchor" href="#azure-service-principal" aria-label="Permalink to &quot;Azure Service Principal&quot;">​</a></h2><h3 id="_1-service-principal-erstellen" tabindex="-1">1. Service Principal erstellen <a class="header-anchor" href="#_1-service-principal-erstellen" aria-label="Permalink to &quot;1. Service Principal erstellen&quot;">​</a></h3><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Für Staging</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$spStaging </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> az ad sp create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">for</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rbac </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">\`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ScoreHub-GitHub-Staging&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> \`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">role contributor </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">\`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">scopes </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/subscriptions/{subscription-id}/resourceGroups/scorehub-staging-rg&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> \`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sdk</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">auth</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Für Production</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$spProduction </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> az ad sp create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">for</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rbac </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">\`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ScoreHub-GitHub-Production&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> \`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">role contributor </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">\`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">scopes </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/subscriptions/{subscription-id}/resourceGroups/scorehub-production-rg&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> \`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sdk</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">auth</span></span></code></pre></div><h3 id="_2-output-speichern" tabindex="-1">2. Output speichern <a class="header-anchor" href="#_2-output-speichern" aria-label="Permalink to &quot;2. Output speichern&quot;">​</a></h3><p>Der Output sieht so aus:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;clientId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;clientSecret&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;subscriptionId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;tenantId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;activeDirectoryEndpointUrl&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://login.microsoftonline.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;resourceManagerEndpointUrl&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://management.azure.com/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;activeDirectoryGraphResourceId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://graph.windows.net/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;sqlManagementEndpointUrl&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://management.core.windows.net:8443/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;galleryEndpointUrl&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://gallery.azure.com/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;managementEndpointUrl&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://management.core.windows.net/&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="secrets-konfigurieren" tabindex="-1">Secrets konfigurieren <a class="header-anchor" href="#secrets-konfigurieren" aria-label="Permalink to &quot;Secrets konfigurieren&quot;">​</a></h2><h3 id="repository-secrets" tabindex="-1">Repository Secrets <a class="header-anchor" href="#repository-secrets" aria-label="Permalink to &quot;Repository Secrets&quot;">​</a></h3><p>GitHub → Settings → Secrets and variables → Actions → New repository secret</p><table tabindex="0"><thead><tr><th>Secret Name</th><th>Wert</th><th>Beschreibung</th></tr></thead><tbody><tr><td><code>AZURE_CREDENTIALS_STAGING</code></td><td>JSON Output</td><td>Service Principal für Staging</td></tr><tr><td><code>AZURE_CREDENTIALS_PRODUCTION</code></td><td>JSON Output</td><td>Service Principal für Production</td></tr></tbody></table><h3 id="environment-secrets-staging" tabindex="-1">Environment Secrets (Staging) <a class="header-anchor" href="#environment-secrets-staging" aria-label="Permalink to &quot;Environment Secrets (Staging)&quot;">​</a></h3><p>GitHub → Settings → Environments → staging → Add secret</p><table tabindex="0"><thead><tr><th>Secret Name</th><th>Wert</th><th>Beschreibung</th></tr></thead><tbody><tr><td><code>AZURE_STATIC_WEB_APPS_API_TOKEN_STAGING</code></td><td>Token</td><td>Static Web App API Token</td></tr><tr><td><code>AZURE_CREDENTIALS_STAGING</code></td><td>JSON</td><td>Azure Service Principal Credentials</td></tr><tr><td><code>SQL_SERVER_STAGING</code></td><td><code>scorehub-staging-sql.database.windows.net</code></td><td>SQL Server FQDN</td></tr><tr><td><code>SQL_DATABASE_STAGING</code></td><td><code>scorehub-staging-db</code></td><td>Datenbank Name</td></tr><tr><td><code>SQL_USER_STAGING</code></td><td><code>scorehubadmin</code></td><td>SQL Admin User</td></tr><tr><td><code>SQL_PASSWORD_STAGING</code></td><td>Ihr Passwort</td><td>SQL Admin Password</td></tr><tr><td><code>VITE_API_BASE_URL</code></td><td><code>https://scorehub-staging-api.azurewebsites.net/api</code></td><td>API URL</td></tr><tr><td><code>VITE_MSAL_CLIENT_ID</code></td><td>B2C Client ID</td><td>Azure AD B2C Client ID</td></tr><tr><td><code>VITE_MSAL_AUTHORITY</code></td><td>B2C Authority URL</td><td>Azure AD B2C Authority</td></tr><tr><td><code>VITE_MSAL_KNOWN_AUTHORITY</code></td><td>B2C Known Authority</td><td>Azure AD B2C Known Authority</td></tr></tbody></table><p><strong>Wichtig für automatische DB-Migrationen:</strong> Die Secrets <code>SQL_SERVER_STAGING</code>, <code>SQL_DATABASE_STAGING</code>, <code>SQL_USER_STAGING</code> und <code>SQL_PASSWORD_STAGING</code> werden vom CI/CD Workflow verwendet, um automatisch Datenbank-Migrationen beim Deployment auszuführen.</p><h3 id="environment-secrets-production" tabindex="-1">Environment Secrets (Production) <a class="header-anchor" href="#environment-secrets-production" aria-label="Permalink to &quot;Environment Secrets (Production)&quot;">​</a></h3><p>Gleiche Secrets wie Staging, aber mit Production-Werten.</p><h2 id="static-web-app-token-abrufen" tabindex="-1">Static Web App Token abrufen <a class="header-anchor" href="#static-web-app-token-abrufen" aria-label="Permalink to &quot;Static Web App Token abrufen&quot;">​</a></h2><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Staging</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$stagingToken </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> az staticwebapp secrets list </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">\`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;scorehub-staging-web&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> \`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">query </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;properties.apiKey&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">o tsv</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Write-Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Staging Token: </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$stagingToken</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Production</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$productionToken </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> az staticwebapp secrets list </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">\`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;scorehub-production-web&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> \`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">query </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;properties.apiKey&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">o tsv</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Write-Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Production Token: </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$productionToken</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span></code></pre></div><h2 id="secrets-via-github-cli" tabindex="-1">Secrets via GitHub CLI <a class="header-anchor" href="#secrets-via-github-cli" aria-label="Permalink to &quot;Secrets via GitHub CLI&quot;">​</a></h2><p>Alternativ können Sie Secrets via CLI setzen:</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Repository Secret</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gh secret set AZURE_CREDENTIALS_STAGING </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">body </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$spStaging</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Environment Secret</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gh secret set SQL_ADMIN_PASSWORD </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">\`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">env staging </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">\`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">body </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;YourSecurePassword&quot;</span></span></code></pre></div><h2 id="secrets-ubersicht" tabindex="-1">Secrets Übersicht <a class="header-anchor" href="#secrets-ubersicht" aria-label="Permalink to &quot;Secrets Übersicht&quot;">​</a></h2><h3 id="alle-konfigurierten-secrets-prufen" tabindex="-1">Alle konfigurierten Secrets prüfen <a class="header-anchor" href="#alle-konfigurierten-secrets-prufen" aria-label="Permalink to &quot;Alle konfigurierten Secrets prüfen&quot;">​</a></h3><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Repository Secrets</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gh secret list</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Environment Secrets</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gh secret list </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">env staging</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gh secret list </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">env production</span></span></code></pre></div><h2 id="rotation" tabindex="-1">Rotation <a class="header-anchor" href="#rotation" aria-label="Permalink to &quot;Rotation&quot;">​</a></h2><h3 id="service-principal-secret-rotieren" tabindex="-1">Service Principal Secret rotieren <a class="header-anchor" href="#service-principal-secret-rotieren" aria-label="Permalink to &quot;Service Principal Secret rotieren&quot;">​</a></h3><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Neues Secret erstellen</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$newSecret </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> az ad sp credential reset </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">\`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">id </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ScoreHub-GitHub-Staging&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> \`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">query password </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">o tsv</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># In GitHub aktualisieren</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># (manuell oder via CLI)</span></span></code></pre></div><h3 id="sql-password-rotieren" tabindex="-1">SQL Password rotieren <a class="header-anchor" href="#sql-password-rotieren" aria-label="Permalink to &quot;SQL Password rotieren&quot;">​</a></h3><ol><li>Azure Portal → SQL Server → Reset password</li><li>GitHub Secret aktualisieren</li><li>Key Vault Secret aktualisieren</li><li>Function App neu starten</li></ol><h2 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">​</a></h2><h3 id="secret-nicht-gefunden" tabindex="-1">Secret nicht gefunden <a class="header-anchor" href="#secret-nicht-gefunden" aria-label="Permalink to &quot;Secret nicht gefunden&quot;">​</a></h3><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Falscher Zugriff</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\${{ secrets.WRONG_NAME }}</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # undefined</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Richtiger Zugriff</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\${{ secrets.AZURE_CREDENTIALS_STAGING }}</span></span></code></pre></div><h3 id="environment-secret-vs-repository-secret" tabindex="-1">Environment Secret vs Repository Secret <a class="header-anchor" href="#environment-secret-vs-repository-secret" aria-label="Permalink to &quot;Environment Secret vs Repository Secret&quot;">​</a></h3><ul><li><strong>Repository Secrets</strong>: Verfügbar in allen Jobs</li><li><strong>Environment Secrets</strong>: Nur in Jobs mit <code>environment:</code> Block</li></ul><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Environment Secret nutzen</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">jobs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  deploy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">staging</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Erforderlich!</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    steps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">echo \${{ secrets.SQL_ADMIN_PASSWORD }}</span></span></code></pre></div><h3 id="debug-secrets-ohne-sie-anzuzeigen" tabindex="-1">Debug Secrets (ohne sie anzuzeigen) <a class="header-anchor" href="#debug-secrets-ohne-sie-anzuzeigen" aria-label="Permalink to &quot;Debug Secrets (ohne sie anzuzeigen)&quot;">​</a></h3><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Check if secret exists</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    if [ -n &quot;\${{ secrets.MY_SECRET }}&quot; ]; then</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      echo &quot;Secret is set&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    else</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      echo &quot;Secret is NOT set&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    fi</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">Sicherheit</p><p>Niemals Secrets in Logs ausgeben oder in Code committen!</p></div><div class="tip custom-block"><p class="custom-block-title">Setup abgeschlossen!</p><p>Sie haben alle Komponenten konfiguriert. Fahren Sie mit der <a href="/development/">Entwicklungsanleitung</a> fort.</p></div>`,47)])])}const E=i(n,[["render",l]]);export{c as __pageData,E as default};
